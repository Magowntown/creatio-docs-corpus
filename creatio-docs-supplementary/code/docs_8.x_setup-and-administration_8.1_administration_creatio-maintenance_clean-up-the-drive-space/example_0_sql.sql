IF OBJECT_ID('tempdb..#UsedCultures') IS NOT NULL       DROP Table #UsedCultures-- Get a list of used culturesSELECT DISTINCT cult.IdINTO #UsedCulturesFROM SysCulture cultINNER JOIN SysAdminUnit au       ON au.SysCultureId = cult.IdINSERT INTO #UsedCultures       (Id)SELECT       SysSettingsValue.GuidValueFROM       SysSettingsValueINNER JOIN SysSettings       ON SysSettings.Id = SysSettingsValue.SysSettingsIdWHERE       SysSettings.Code = 'PrimaryCulture'-- Get a list of tables from which to delete dataDECLARE TableNamesCursor CURSOR FORSELECT        t3.TABLE_NAME AS ChildTableName  FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS AS t1         INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS t2 ON t1.UNIQUE_CONSTRAINT_NAME = t2.CONSTRAINT_NAME        INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS t3 ON t1.CONSTRAINT_NAME = t3.CONSTRAINT_NAMEWHERE       t2.TABLE_NAME = 'SysCulture'       and t2.COLUMN_NAME = 'Id'       and t3.COLUMN_NAME = 'SysCultureId'DECLARE @TableName SYSNAMEOPEN TableNamesCursorFETCH NEXT FROM TableNamesCursor INTO @TableNameWHILE @@FETCH_STATUS = 0  BEGIN         PRINT @TableName       DECLARE @Sql NVARCHAR(MAX);       SET @Sql = 'DELETE FROM ' + @TableName + '            WHERE SysCultureId NOT IN (SELECT Id FROM #UsedCultures)';       PRINT @Sql       EXECUTE sp_executesql @Sql       FETCH NEXT FROM TableNamesCursor INTO @TableNameENDCLOSE TableNamesCursorDEALLOCATE TableNamesCursorDELETE FROM SysCultureWHERE Id NOT IN (SELECT Id FROM #UsedCultures)IF OBJECT_ID('tempdb..#UsedCultures') IS NOT NULL       DROP Table #UsedCultures