BEGIN;-- Get a list of used culturesCREATE TEMP TABLE "UsedCultures" ON COMMIT DROP ASSELECT DISTINCT cult."Id"FROM "SysCulture" cultINNER JOIN "SysAdminUnit" auON au."SysCultureId" = cult."Id";INSERT INTO "UsedCultures" ("Id")SELECT "SysSettingsValue"."GuidValue"FROM "SysSettingsValue"INNER JOIN "SysSettings"ON "SysSettings"."Id" = "SysSettingsValue"."SysSettingsId"WHERE "SysSettings"."Code" = 'PrimaryCulture';	-- Get a list of tables from which to delete dataDO $$DECLARETableNamesCursor REFCURSOR;TableName varchar;BEGINOPEN TableNamesCursor FORSELECT kcu.TABLE_NAMEFROM INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE ccuINNER JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS rc    ON ccu.CONSTRAINT_CATALOG = rc.UNIQUE_CONSTRAINT_CATALOG    AND ccu.CONSTRAINT_SCHEMA = rc.UNIQUE_CONSTRAINT_SCHEMA    AND ccu.CONSTRAINT_NAME = rc.UNIQUE_CONSTRAINT_NAMEINNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu    ON kcu.CONSTRAINT_CATALOG = rc.CONSTRAINT_CATALOG    AND kcu.CONSTRAINT_SCHEMA = rc.CONSTRAINT_SCHEMA    AND kcu.CONSTRAINT_NAME = rc.CONSTRAINT_NAMEWHERE ccu.COLUMN_NAME = 'Id'  AND ccu.TABLE_SCHEMA = 'public'  AND ccu.TABLE_NAME = 'SysCulture';--Delete localizationsLOOPFETCH TableNamesCursor INTO TableName;EXIT WHEN TableName IS NULL;RAISE NOTICE 'Deleting from table %', TableName;EXECUTE format('DELETE FROM %I WHERE "SysCultureId" NOT IN (SELECT "Id" FROM "UsedCultures")', TableName);END LOOP;CLOSE TableNamesCursor;END $$;DELETE FROM "SysCulture"WHERE "Id" NOT IN (SELECT "Id" FROM "UsedCultures");COMMIT