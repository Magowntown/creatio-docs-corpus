namespace Terrasoft.Configuration.Omnichannel.Messaging{    using Common;    using Core;    using OmnichannelProviders;    using OmnichannelProviders.Interfaces;    using OmnichannelProviders.MessageWorkers;    using Terrasoft.Core.Factories;    using Web.Common;    #region Class : SomeProviderAppEventListener    /* Run prerequisites for "OmnichannelMessaging" on app start. */    public class SomeProviderAppEventListener : AppEventListenerBase    {        #region Fields : Protected        protected UserConnection UserConnection {            get;            private set;        }        #endregion        #region Methods : Protected        /* Retrieve the user connection from the app event scope.        The "context" parameter is the app event scope.        Return user connection. */        protected UserConnection GetUserConnection(AppEventContext context) {            var appConnection = context.Application["AppConnection"] as AppConnection;            if (appConnection == null) {                throw new ArgumentNullOrEmptyException("AppConnection");            }            return appConnection.SystemUserConnection;        }        protected void BindInterfaces() {            ClassFactory.Bind<IAttachmentsLoadWorker, SomeChannelProviderNameAttachmentLoadWorker>(ChannelType.ThirdParty.ToString());            ClassFactory.Bind<IProfileDataProvider, SomeChannelProviderNameProfileDataProvider>(ChannelType.ThirdParty.ToString());            ClassFactory.Bind<IOutcomeMessageWorker, SomeChannelProviderNameOutcomeMessageWorker>(ChannelType.ThirdParty.ToString());        }        #endregion        #region Methods : Public        /* Handle the app start.        The "context" parameter is the app event scope. */        public override void OnAppStart(AppEventContext context) {            base.OnAppStart(context);            UserConnection = GetUserConnection(context);            BindInterfaces();        }        #endregion    }    #endregion}