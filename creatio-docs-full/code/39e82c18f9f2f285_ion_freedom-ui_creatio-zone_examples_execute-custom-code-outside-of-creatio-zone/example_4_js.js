/* Declare the AMD module. */define("UsrRequests_FormPage", /**SCHEMA_DEPS*/["@creatio-devkit/common"]/**SCHEMA_DEPS*/, function/**SCHEMA_ARGS*/(sdk)/**SCHEMA_ARGS*/ {    return {        viewConfigDiff: /**SCHEMA_VIEW_CONFIG_DIFF*/[            {                "operation": "merge",                "name": "Feed",                "values": {                    "dataSourceName": "PDS",                    "entitySchemaName": "UsrRequests"                }            },            {                "operation": "merge",                "name": "AttachmentList",                "values": {                    "columns": [                        {                            "id": "2756ad1d-3f63-4d21-9e4f-f4c3ad260326",                            "code": "AttachmentListDS_Name",                            "caption": "#ResourceString(AttachmentListDS_Name)#",                            "dataValueType": 28,                            "width": 200                        }                    ]                }            },            /* Button that calls the {JSON} Placeholder external web service from the request page. */            {                "operation": "insert",                "name": "ShowEmailsButton",                "values": {                    "type": "crt.Button",                    "caption": "#ResourceString(ShowEmailsButton_caption)#",                    "color": "default",                    "disabled": false,                    "size": "large",                    "iconPosition": "only-text",                    "visible": true,                    "clicked": {                        /* Bind the sending of the custom request to the clicked button event. */                        "request": "usr.ShowEmailsRequest"                    }                },                "parentName": "CardToolsContainer",                "propertyName": "items",                "index": 0            },            /* Button that opens the Contacts section. */            {                "operation": "insert",                "name": "OpenContactsButton",                "values": {                    "type": "crt.Button",                    "caption": "#ResourceString(OpenContactsButton_caption)#",                    "color": "primary",                    "disabled": false,                    "size": "large",                    "iconPosition": "only-text",                    "visible": true,                    "clicked": {                        /* Bind the sending of the custom request to the clicked button event. */                        "request": "crt.OpenPageRequest",                        "params": {                            "schemaName": "Contacts_ListPage"                        }                    }                },                "parentName": "CardToolsContainer",                "propertyName": "items",                "index": 1            },            {                "operation": "insert",                "name": "UsrName",                "values": {                    "layoutConfig": {                        "column": 1,                        "row": 1,                        "colSpan": 1,                        "rowSpan": 1                    },                    "type": "crt.Input",                    "label": "$Resources.Strings.UsrName",                    "control": "$UsrName",                    "labelPosition": "auto"                },                "parentName": "SideAreaProfileContainer",                "propertyName": "items",                "index": 0            }        ]/**SCHEMA_VIEW_CONFIG_DIFF*/,        viewModelConfigDiff: /**SCHEMA_VIEW_MODEL_CONFIG_DIFF*/[            {                "operation": "merge",                "path": [                    "attributes"                ],                "values": {                    "UsrName": {                        "modelConfig": {                            "path": "PDS.UsrName"                        }                    }                }            },            {                "operation": "merge",                "path": [                    "attributes",                    "Id",                    "modelConfig"                ],                "values": {                    "path": "PDS.Id"                }            }        ]/**SCHEMA_VIEW_MODEL_CONFIG_DIFF*/,        modelConfigDiff: /**SCHEMA_MODEL_CONFIG_DIFF*/[            {                "operation": "merge",                "path": [],                "values": {                    "primaryDataSourceName": "PDS"                }            },            {                "operation": "merge",                "path": [                    "dataSources"                ],                "values": {                    "PDS": {                        "type": "crt.EntityDataSource",                        "config": {                            "entitySchemaName": "UsrRequests"                        },                        "scope": "page"                    }                }            }        ]/**SCHEMA_MODEL_CONFIG_DIFF*/,        handlers: /**SCHEMA_HANDLERS*/[            {                request: "usr.ShowEmailsRequest",                /* Implement the custom request handler. */                handler: async (request, next) => {                    /* Create an instance of the CrtZoneService service. */                    const zoneService = new sdk.CrtZoneService();                    /* Create an instance of the HttpClientService service. */                    const httpClientService = new sdk.HttpClientService();                    /* Specify the URL to retrieve emails from post comments. Use the {JSON} Placeholder external service. */                    const postsEndpoint = "https://jsonplaceholder.typicode.com/posts";                    /* Implement the business logic to switch between pages regardless of whether the request to the web service is complete or still in progress. */                    zoneService.runOutside(async () => {                        const collectedEmails = [];                        /* Retrieve emails from comments to 10 posts. */                        for (let postsId = 1; postsId <= 10; postsId++) {                            const commends = await httpClientService.get(`${postsEndpoint}/${postsId}/comments`);                            const commentEmails = commends.body.map(comment => comment.email);                            collectedEmails.push(...commentEmails);                        }                        alert(`Post comments have been successfully processed.` + '\n\n' + `Selected posts are commented by users with following emails:` + '\n' + collectedEmails.join(', '));                    });                }            }        ]/**SCHEMA_HANDLERS*/,        converters: /**SCHEMA_CONVERTERS*/{}/**SCHEMA_CONVERTERS*/,        validators: /**SCHEMA_VALIDATORS*/{}/**SCHEMA_VALIDATORS*/    };});