IEnumerable <IEnumerable <ImportEntity>> GetImportEntitiesChunks(IEnumerable <ImportEntity> entities, IEnumerable <ImportColumn> keyColumns) {    var entitiesList = entities.ToList();    var columnsList = keyColumns.ToList();    var maxParamsPerChunk = Math.Abs(MaxParametersCountPerQueryChunk / columnsList.Count + 1);    var chunksCount = (int) Math.Ceiling(entitiesList.Count / (double) maxParamsPerChunk);    return entitiesList.SplitOnParts(chunksCount);}var entitiesList = GetImportEntitiesChunks(entities, importColumns);entitiesList.AsParallel().AsOrdered()    .ForAll(entitiesBatch => {        try {            var insertQuery = GetBufferedImportEntityInsertQuery();            foreach(var importEntity in entitiesBatch) {                insertQuery.Values();                SetBufferedImportEntityInsertColumnValues(importEntity, insertQuery,                    importColumns);                insertQuery.Set("ImportSessionId", Column.Parameter(importSessionId));            }            insertQuery.Execute();        } catch (Exception e) {            //...        }    });