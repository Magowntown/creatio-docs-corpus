namespace Terrasoft.Configuration.Omnichannel.Messaging {    using Common;    using Core;    using Terrasoft.Core.Factories;    using Web.Common;    #region Class: TestAppEventListener    /// <summary>    /// The class that runs prerequisites for OmnichannelMessaging on the application start.    /// </summary>    public class TestAppEventListener: AppEventListenerBase {        #region Fields: Protected        protected UserConnection UserConnection {            get;            private set;        }        #endregion        #region Methods: Protected        /// <summary>        /// Retrieve the user connection from the application event scope.        /// </summary>        /// <param name="context">The application event scope.</param>        /// <returns>User connection.</returns>        protected UserConnection GetUserConnection(AppEventContext context) {            var appConnection = context.Application["AppConnection"] as AppConnection;            if (appConnection == null) {                throw new ArgumentNullOrEmptyException("AppConnection");            }            return appConnection.SystemUserConnection;        }        protected void BindInterfaces() {            ClassFactory.Bind < IOperatorRoutingRule,            TestOperatorRoutingRule > ("TestRule");        }        #endregion        #region Methods: Public        /// <summary>        /// Handle the application start.        /// </summary>        /// <param name="context">The application event scope.</param>        public override void OnAppStart(AppEventContext context) {            base.OnAppStart(context);            UserConnection = GetUserConnection(context);            BindInterfaces();        }        #endregion    }    #endregion}