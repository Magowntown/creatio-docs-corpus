namespace Terrasoft.Configuration {    using System.ServiceModel;    using System.ServiceModel.Web;    using System.ServiceModel.Activation;    using System.Web;    using Terrasoft.Core;    using Terrasoft.Core.Entities;    using System;    using System.Collections.Generic;    [ServiceContract]    [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]    public class UsrViewLocalizationService: System.Web.SessionState.IReadOnlySessionState {        /* The method that returns the index of contact address types and values from the "UsrContactAddressVw" view in the primary language. */        [OperationContract]        [WebInvoke(Method = "GET", UriTemplate = "GetNonLocalizableView")]        public string GetNonLocalizableView() {            var userConnection = (UserConnection) HttpContext.Current.Session["UserConnection"];                        /* The EntitySchemaQuery instance that accesses the "UsrContactAddressVw" database table. */            var esqResult = new EntitySchemaQuery(userConnection.EntitySchemaManager, "UsrContactAddressVw");                        /* Add columns to the query. */            esqResult.AddColumn("UsrContactAddressType");            esqResult.AddColumn("UsrContactAddressValue");            /* Retrieve the query results. */            var entities = esqResult.GetEntityCollection(userConnection);            var s = "";            foreach(var item in entities) {                s += item.GetTypedColumnValue<string>("UsrContactAddressType") + ": ";                s += item.GetTypedColumnValue<string>("UsrContactAddressValue") + "; ";            }            return s;        }        /* The method that returns the index of contact address types and values from the "UsrContactAddressVw" view in an additional language. */        [OperationContract]        [WebInvoke(Method = "GET", UriTemplate = "GetLocalizableView")]        public string GetLocalizableView() {            var userConnection = (UserConnection) HttpContext.Current.Session["UserConnection"];                        /* Retrieve the ID of the primary language. */            var sysCulture = new SysCulture(userConnection);                        /* Return an error message if the primary language is not found. */            if (!sysCulture.FetchPrimaryInfoFromDB("Name", "en-us")) {                return "No culture found";            }            Guid CultureId = sysCulture.Id;            /* The EntitySchemaQuery instance that accesses the "UsrContactAddressVw" database table. */            var esqResult = new EntitySchemaQuery(userConnection.EntitySchemaManager, "UsrContactAddressVw");                        /* Add columns to the query. */            esqResult.AddColumn("UsrContactAddressType");            esqResult.AddColumn("UsrContactAddressValue");            esqResult.SetLocalizationCultureId(CultureId);            /* Retrieve the query results. */            var entities = esqResult.GetEntityCollection(userConnection);            var s = "";            foreach(var item in entities) {                s += item.GetTypedColumnValue<string>("UsrContactAddressType") + ": ";                s += item.GetTypedColumnValue<string>("UsrContactAddressValue") + "; ";            }            return s;        }    }}