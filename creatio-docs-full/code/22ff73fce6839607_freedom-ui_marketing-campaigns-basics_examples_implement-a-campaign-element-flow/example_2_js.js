define("UsrSmsConditionalTransitionPropertiesPanel", ["BusinessRuleModule",    "LookupUtilities"], function(BusinessRuleModule, LookupUtilities) {        return {            messages: {},            /* Schema attributes. */            attributes: {                /* Attribute that stores data about list of participants. */                "ReactionModeEnum": {                    dataValueType: this.Terrasoft.DataValueType.CUSTOM_OBJECT,                    type: this.Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,                    value: {                        Default: {                            value: "0",                            captionName: "Resources.Strings.ReactionModeDefault"                        },                        WithCondition: {                            value: "1",                            captionName: "Resources.Strings.ReactionModeWithCondition"                        }                    }                },                /* Attribute that stores data about participants' responses. */                "ReactionMode": {                    "dataValueType": this.Terrasoft.DataValueType.LOOKUP,                    "type": this.Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,                    "isRequired": true                },                /* Attribute that stores data about SMS delivery status. */                "IsSmsDelivered": {                    "dataValueType": this.Terrasoft.DataValueType.BOOLEAN,                    "type": this.Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN                },                /* Attribute that stores data about error occurred while                receiving SMS. */                "IsErrorWhileReceiving": {                    "dataValueType": this.Terrasoft.DataValueType.BOOLEAN,                    "type": this.Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN                }            },            /* Schema business rules. */            rules: {                /* Make the "ReactionConditionDecision" business rule                required when the "ReactionMode" attribute is equal "1." */                "ReactionConditionDecision": {                    "BindReactionConditionDecisionRequiredToReactionMode": {                        "ruleType": BusinessRuleModule.enums.RuleType.BINDPARAMETER,                        "property": BusinessRuleModule.enums.Property.REQUIRED,                        "conditions": [{                            "leftExpression": {                                "type": BusinessRuleModule.enums.ValueType.ATTRIBUTE,                                "attribute": "ReactionMode"                            },                            "comparisonType": this.Terrasoft.ComparisonType.EQUAL,                            "rightExpression": {                                "type": BusinessRuleModule.enums.ValueType.CONSTANT,                                "value": "1"                            }                        }]                    }                }            },            /* Schema methods. */            methods: {                /* Return mapping of attributes to the "SMS response                type" ("SmsResponseType" code) lookup records. */                getResponseConfig: function() {                    return {                        "IsSmsDelivered": "5a9f08a4-c7f2-4dc8-9940-13ba1b2762cf",                        "IsErrorWhileReceiving": "4a790626-bfbb-4ca7-a9f2-595000262561"                    };                },                /* Bind the handler to the event that changes the "ReactionMode"                attribute value. */                subscribeEvents: function() {                    this.callParent(arguments);                    /* Subscribe to changes of the "ReactionMode" attribute                    value. */                    this.on(                        "change:ReactionMode",                        this.onReactionModeLookupChanged,                        this                    );                },                /* Handle the ReactionMode attribute change event. */                onReactionModeLookupChanged: function() {                    var reactionModeEnum = this.get("ReactionModeEnum");                    var reactionMode = this.get("ReactionMode");                    var decisionModeEnabled =(reactionMode &&                        reactionMode.value === reactionModeEnum.WithCondition.value);                    if (!decisionModeEnabled) {                        this.set("ReactionConditionDecision", null);                    }                },                /* Initialize attributes for displaying the page when opened. */                initParameters: function(element) {                    this.callParent(arguments);                    var isResponseBasedStart = element.isResponseBasedStart;                    this.initReactionMode(isResponseBasedStart);                    this.initSmsResponses(element.smsResponseId);                },                /* Cut the string to the specified length and append an                ellipsis at the end. Auxiliary method. */                cutString: function(strValue, strLength) {                    var ellipsis = Ext.String.ellipsis(                        strValue.substring(strLength),                        0                    );                    return strValue.substring(0, strLength) + ellipsis;                },                /* Set the status value to "Delivered." */                initIsSmsDelivered: function(value) {                    if (value === undefined) {                        value = this.get("IsSmsDelivered");                    }                    this.set("IsSmsDelivered", value);                },                /* Set the status value to "Error while receiving." */                initIsErrorWhileReceiving: function(value) {                    if (value === undefined) {                        var isErrorWhileReceiving = this.get("IsErrorWhileReceiving");                        value = isErrorWhileReceiving;                    }                    this.set("IsErrorWhileReceiving", value);                },                /* Initialize the selected responses when opening the page. */                initSmsResponses: function(responseIdsJson) {                    if (!responseIdsJson) {                        return;                    }                    var responseIds = JSON.parse(responseIdsJson);                    var config = this.getResponseConfig();                    Terrasoft.each(config, function(propValue, propName) {                        if (responseIds.indexOf(propValue) > -1) {                            this.set(propName, true);                        }                    }, this);                },                /* Initialize the "ReactionMode" attribute based on                "isResponseBasedStart." */                initReactionMode: function(value) {                    var isDefault = !value;                    this.setLookupValue(                        isDefault,                        "ReactionMode",                        "WithCondition",                        this                    );                },                /* Parse JSON array of IDs. Return "[]" on error. */                getIds: function(idsJson) {                    if (idsJson) {                        try {                            var ids = JSON.parse(idsJson);                            if (this.Ext.isArray(ids)) {                                return ids;                            }                        } catch (error) {                            return [];                        }                    }                    return [];                },                /* Populate "ReactionMode" attribute list from "ReactionModeEnum". */                onPrepareReactionModeList: function(filter, list) {                    this.prepareList("ReactionModeEnum", list, this);                },                /* Save UI values back to the process element before save. */                saveValues: function() {                    this.callParent(arguments);                    var element = this.get("ProcessElement");                    var isResponseBasedStart = this.getIsReactionModeWithConditions();                    element.isResponseBasedStart = isResponseBasedStart;                    element.smsResponseId = this.getSmsResponseId(isResponseBasedStart);                },                /* Serialize selected response IDs to JSON.*/                getSmsResponseId: function(isResponseActive) {                    var responseIds = [];                    if (isResponseActive) {                        var config = this.getResponseConfig();                        Terrasoft.each(config, function(propValue, propName) {                            var attrValue = this.get(propName);                            if (attrValue && propValue) {                                responseIds.push(propValue);                            }                        }, this);                    }                    return JSON.stringify(responseIds);                },                /* Return lookup underlying ID or null. */                getLookupValue: function(parameterName) {                    var value = this.get(parameterName);                    return value ? value.value : null;                },                /* Help context code for the property page. */                getContextHelpCode: function() {                    return "CampaignConditionalSequenceFlow";                },                /* Return "true" if "ReactionMode" is set to "1." */                getIsReactionModeWithConditions: function() {                    return this.isLookupValueEqual("ReactionMode", "1", this);                },                /* Return source element of the transition if available. */                getSourceElement: function() {                    var flowElement = this.get("ProcessElement");                    if (flowElement) {                        return flowElement.findSourceElement();                    }                    return null;                },                /* Format question caption including the source element name. */                getQuestionCaption: function() {                    var caption = this.get("Resources.Strings.ReactionModeCaption");                    caption = this.Ext.String.format(                        caption,                        this.getSourceElement().getCaption()                    );                    return caption;                }            },            /* The schema view description. */            diff: /**SCHEMA_DIFF*/[                /* Page container.*/                {                    "operation": "insert",                    "name": "ReactionContainer",                    "propertyName": "items",                    "parentName": "ContentContainer",                    "className": "Terrasoft.GridLayoutEdit",                    "values":                    {                        "layout":                        {                            "column": 0,                            "row": 2,                            "colSpan": 24                        },                        "itemType": this.Terrasoft.ViewItemType.GRID_LAYOUT,                        "items": []                    }                },                /* Title label. */                {                    "operation": "insert",                    "name": "ReactionModeLabel",                    "parentName": "ReactionContainer",                    "propertyName": "items",                    "values":                    {                        "layout":                        {                            "column": 0,                            "row": 0,                            "colSpan": 24                        },                        "itemType": this.Terrasoft.ViewItemType.LABEL,                        "caption":                        {                            "bindTo": "getQuestionCaption"                        },                        "classes":                        {                            "labelClass": ["t-title-label-proc"]                        }                    }                },                /* "ReactionMode" list. */                {                    "operation": "insert",                    "name": "ReactionMode",                    "parentName": "ReactionContainer",                    "propertyName": "items",                    "values":                    {                        "contentType": this.Terrasoft.ContentType.ENUM,                        "controlConfig":                        {                            "prepareList":                            {                                "bindTo": "onPrepareReactionModeList"                            }                        },                        "isRequired": true,                        "layout":                        {                            "column": 0,                            "row": 1,                            "colSpan": 24                        },                        "labelConfig":                        {                            "visible": false                        },                        "wrapClass": ["no-caption-control"]                    }                },                /* "IsSmsDelivered" checkbox.*/                {                    "operation": "insert",                    "parentName": "ReactionContainer",                    "propertyName": "items",                    "name": "IsSmsDelivered",                    "values":                    {                        "wrapClass": ["t-checkbox-control"],                        "visible":                        {                            "bindTo": "ReactionMode",                            "bindConfig":                            {                                converter: "getIsReactionModeWithConditions"                            }                        },                        "caption":                        {                            "bindTo": "Resources.Strings.IsSmsDelivered"                        },                        "layout":                        {                            "column": 0,                            "row": 2,                            "colSpan": 22                        }                    }                },                /* "IsErrorWhileReceiving" checkbox.*/                {                    "operation": "insert",                    "parentName": "ReactionContainer",                    "propertyName": "items",                    "name": "IsErrorWhileReceiving",                    "values":                    {                        "wrapClass": ["t-checkbox-control"],                        "visible":                        {                            "bindTo": "ReactionMode",                            "bindConfig":                            {                                converter: "getIsReactionModeWithConditions"                            }                        },                        "caption":                        {                            "bindTo": "Resources.Strings.IsErrorWhileReceiving"                        },                        "layout":                        {                            "column": 0,                            "row": 3,                            "colSpan": 22                        }                    }                }            ]/**SCHEMA_DIFF*/        };    });