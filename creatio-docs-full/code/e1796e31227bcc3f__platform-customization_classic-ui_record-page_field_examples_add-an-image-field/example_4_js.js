/* Declare the AMD module. */define("KnowledgeBasePageV2", ["KnowledgeBasePageV2Resources", "ConfigurationConstants"], function(resources, ConfigurationConstants) {    return {        /* The name of the record page object's schema. */        entitySchemaName: "KnowledgeBase",        /* The methods of the record page's view model. */        methods: {            /* Call before the image selection box opens. */            beforePhotoFileSelected: function() {                return true;            },            /* Receive the image by link. */            getPhotoSrcMethod: function() {                /* Receive the image link from the object column. */                var imageColumnValue = this.get("UsrLogo");                /* If the link is specified, return the image file URL. */                if (imageColumnValue) {                    return this.getSchemaImageUrl(imageColumnValue);                }                /* If the link is not specified, return the default image. */                return this.Terrasoft.ImageUrlBuilder.getUrl(this.get("Resources.Images.DefaultLogo"));            },            /* Handle the image change.             photo is the image file. */            onPhotoChange: function(photo) {                if (!photo) {                    this.set("UsrLogo", null);                    return;                }                /* Upload the file to the database. Call onPhotoUploaded once the upload finishes. */                this.Terrasoft.ImageApi.upload({                    file: photo,                    onComplete: this.onPhotoUploaded,                    onError: this.Terrasoft.emptyFn,                    scope: this                });            },            /* Save the link to the changed image.             imageId is the ID of the file saved in the database. */            onPhotoUploaded: function(imageId) {                var imageData = {                    value: imageId,                    displayValue: "Image"                };                /* Assign the image link to the image column. */                this.set("UsrLogo", imageData);            }        },        /* Display the field on the record page. */        diff: /**SCHEMA_DIFF*/[            /* Metadata to add the custom image field to the record page. */            {                /* Add the element to the page. */                "operation": "insert",                /* The meta name of the parent container to add the field. */                "parentName": "Header",                /* Add the image to the parent element's collection of elements. */                "propertyName": "items",                /* The meta name of the image to add. */                "name": "PhotoContainer",                /* The properties to pass to the element's constructor. */                "values": {                    /* Set the type of the added element to "container." */                    "itemType": Terrasoft.ViewItemType.CONTAINER,                    /* The name of the CSS class. */                    "wrapClass": ["image-edit-container"],                    /* Set up the image layout. */                    "layout": {                         /* The column number. */                        "column": 0,                         /* The row number. */                        "row": 0,                         /* The row span. */                        "rowSpan": 3,                         /* The column span. */                        "colSpan": 3                     },                    /* The array of nested elements. */                    "items": []                }            },            /* The "UsrLogo" field contains the account logo. */            {                "operation": "insert",                "parentName": "PhotoContainer",                "propertyName": "items",                "name": "UsrLogo",                "values": {                    /* The method that retrieves the image by link. */                    "getSrcMethod": "getPhotoSrcMethod",                    /* The method that is called upon the image change. */                    "onPhotoChange": "onPhotoChange",                    /* The method that is called before the image selection box opens. */                    "beforeFileSelected": "beforePhotoFileSelected",                    /* The property that flags the image as editable. */                    "readonly": false,                    /* The view generator of the control. */                    "generator": "ImageCustomGeneratorV2.generateCustomImageControl"                }            },            /* Change the layout of the "Name" field. */            {                /* Execute the operation that modifies the existing element. */                "operation": "merge",                "name": "Name",                "parentName": "Header",                "propertyName": "items",                "values": {                    "bindTo": "Name",                    "layout": {                        "column": 3,                        "row": 0,                        "colSpan": 20                    }                }            },            /* Change the layout of the "ModifiedBy" field. */            {                "operation": "merge",                "name": "ModifiedBy",                "parentName": "Header",                "propertyName": "items",                "values": {                    "bindTo": "ModifiedBy",                    "layout": {                        "column": 3,                        "row": 2,                        "colSpan": 20                    }                }            },            /* Change the layout of the "Type" field. */            {                "operation": "merge",                "name": "Type",                "parentName": "Header",                "propertyName": "items",                "values": {                    "bindTo": "Type",                    "layout": {                        "column": 3,                        "row": 1,                        "colSpan": 20                    },                    "contentType": Terrasoft.ContentType.ENUM                }            }        ]/**SCHEMA_DIFF*/    }});