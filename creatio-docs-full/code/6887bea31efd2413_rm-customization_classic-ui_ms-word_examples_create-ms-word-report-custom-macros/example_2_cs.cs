namespace Terrasoft.Configuration{    using System;    using System.CodeDom.Compiler;    using System.Collections.Generic;    using System.Data;    using System.Linq;    using System.Runtime.Serialization;    using System.ServiceModel;    using System.ServiceModel.Web;    using System.ServiceModel.Activation;    using System.Text;    using System.Text.RegularExpressions;    using System.Web;    using Terrasoft.Common;    using Terrasoft.Core;    using Terrasoft.Core.DB;    using Terrasoft.Core.Entities;    using Terrasoft.Core.Packages;    using Terrasoft.Core.Factories;    /* Attribute that stores the macro name. */    [ExpressionConverterAttribute("CurrentUser")]    /* Class that implements the "IExpressionConverter" interface. */    class UsrCurrentUser : IExpressionConverter    {        private UserConnection _userConnection;        /* Implement the "Evaluate()" method of the "IExpressionConverter" interface. */        public string Evaluate(object value, string arguments = "")        {            try            {                _userConnection = (UserConnection)HttpContext.Current.Session["UserConnection"];                /* Return the contact of current user. */                return _userConnection.CurrentUser.ContactName;            }            catch (Exception err)            {                return err.Message;            }        }    }}