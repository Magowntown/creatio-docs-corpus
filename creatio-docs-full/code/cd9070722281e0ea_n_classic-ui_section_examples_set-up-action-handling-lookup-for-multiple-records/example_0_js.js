define("ActivitySectionV2", ["ConfigurationConstants"], function(ConfigurationConstants) {    return {        /* The name of the section object schema. */        entitySchemaName: "Activity",        /* The methods of the section view model. */        methods: {            /* Determine whether the menu item is available. */            isCustomActionEnabled: function() {                /* Attempt to retrieve the array of the selected record IDs. */                var selectedRows = this.get("SelectedRows");                /* Return true if the array contains items (at least one list record is selected), return false otherwise. */                return selectedRows ? (selectedRows.length > 0) : false;            },            /* The action handler method. Opens the [Contacts] lookup. */            setOwner: function() {                /* Define the lookup configuration. */                var config = {                    /* The [Contact] schema. */                    entitySchemaName: "Contact",                    /* Disable multiple selection. */                    multiSelect: false,                    /* Display the [Name] column. */                    columns: ["Name"]                };                /* Open the lookup with a particular configuration and the callback function that triggers when a user clicks the [Select] button. */                this.openLookup(config, this.lookupCallback, this);            },            /* Set the contact selected from the lookup as the owner of the selected activities. */            lookupCallback: function(args) {                /* The ID of the selected lookup record. */                var activeRowId;                /* Retrieve the selected lookup records. */                var lookupSelectedRows = args.selectedRows.getItems();                if (lookupSelectedRows && lookupSelectedRows.length > 0) {                    /* Retrieve the ID of the first selected lookup record. */                    activeRowId = lookupSelectedRows[0].Id;                }                /* Retrieve the array of the selected record IDs. */                var selectedRows = this.get("SelectedRows");                /* Run handling if at least one record was selected and the owner was selected in the lookup. */                if ((selectedRows.length > 0) && activeRowId) {                    /* Create an instance of the batch query class. */                    var batchQuery = this.Ext.create("Terrasoft.BatchQuery");                    /* Update each of the selected records. */                    selectedRows.forEach(function(selectedRowId) {                        /* Create an UpdateQuery class instance with the Activity root schema. */                        var update = this.Ext.create("Terrasoft.UpdateQuery", {                            rootSchemaName: "Activity"                        });                        /* Apply the filter to determine the record to update. */                        update.enablePrimaryColumnFilter(selectedRowId);                        /* Set the [Owner] column to the ID of the contact selected from the lookup. */                        update.setParameterValue("Owner", activeRowId, this.Terrasoft.DataValueType.GUID);                        /* Add a record update query to the batch query. */                        batchQuery.add(update);                    }, this);                    /* Execute the batch server query. */                    batchQuery.execute(function() {                        /* Update the list. */                        this.reloadGridData();                    }, this);                }            },            /* Overload the base virtual method that returns the section action collection. */            getSectionActions: function() {                /* Call the parent method implementation that retrieves the collection of the initialized section actions. */                var actionMenuItems = this.callParent(arguments);                /* Add a separator line. */                actionMenuItems.addItem(this.getButtonMenuItem({                    Type: "Terrasoft.MenuSeparator",                    Caption: ""                }));                /* Add a menu item to the section action index. */                actionMenuItems.addItem(this.getButtonMenuItem({                    /* Bind the menu item caption to the localizable schema string. */                    "Caption": { bindTo: "Resources.Strings.SetOwnerCaption" },                    /* Bind the action handler method. */                    "Click": { bindTo: "setOwner" },                    /* Bind the property of the menu item availability to the value returned by the isCustomActionEnabled method. */                    "Enabled": { bindTo: "isCustomActionEnabled" },                    /* Support the multiple selection mode. */                    "IsEnabledForSelectedAll": true                }));                /* Return the expanded section action collection. */                return actionMenuItems;            }        }    };});