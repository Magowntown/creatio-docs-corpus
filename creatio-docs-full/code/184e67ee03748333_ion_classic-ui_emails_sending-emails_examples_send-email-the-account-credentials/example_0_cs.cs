// IMPORTANT: When implementing// long-running operations,// it is crucial to enable timely and// responsive cancellation. To achieve// this, ensure that your code// is designed to respond appropriately// to cancellation requests using// the context.CancellationToken// mechanism. For more detailed// information and examples,// please, refer to our documentation./* Create an instance of the "EmailClientFactory." */var emailClientFactory = ClassFactory.Get<EmailClientFactory>(new ConstructorArgument("userConnection", UserConnection));/* Set the connection settings for the mail server. */var credentialConfig = new EmailContract.DTO.Credentials {    MailServer = Get<string>("MailServer"),    Port = Get<int>("Port"),    UseSsl = Get<bool>("UseSsl"),    Sender = Get<string>("Sender"),    MailboxPassword = Get<string>("MailboxPassword"),    MailServerType = Get<Guid>("MailServerType"),    SenderEmailAddress = Get<string>("SenderMailbox")};/* Create an instance of the "IEmailSender." */var emailSender = ClassFactory.Get<IEmailSender>(new ConstructorArgument("emailClientFactory", emailClientFactory),    new ConstructorArgument("userConnection", UserConnection));/* Fill out the email parameters. */var message = new EmailContract.DTO.Email {    Sender = credentialConfig.SenderEmailAddress,    Recipients = Get<string>("Recipient").Split(';').ToList<string>(),    Subject = Get<string>("Subject"),    Body = Get<string>("Body"),    Importance = EmailContract.EmailImportance.Normal,        /* Whether the email body is in HTML format. */    IsHtmlBody = true,    /* List of the recipient mailboxes to send copy of the email. Optional.    CopyRecipients = new List<string> { "user@mail.service" },        List of the recipient mailboxes to send blind copy of the email. Optional.    BlindCopyRecipients = new List<string> { "user@mail.service" } */};/* If needed, attach file to the email. *//* Create an attachment. */var attachment = new EmailContract.DTO.Attachment {    /* Attachment ID. */    Id = Guid.NewGuid().ToString(),    /* Attachment title. For example, "Some file.txt." */    Name = "Some file.txt",};/* Attachment data. For example, "Some data." */byte[] data = Encoding.ASCII.GetBytes("Some data");/* Attach file to the email. */attachment.SetData(data);message.Attachments.Add(attachment);/* Send the email. */emailSender.Send(message, credentialConfig);return true;