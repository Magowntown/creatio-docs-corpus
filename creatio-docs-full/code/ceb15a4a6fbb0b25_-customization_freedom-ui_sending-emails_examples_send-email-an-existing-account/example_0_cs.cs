// IMPORTANT: When implementing// long-running operations,// it is crucial to enable timely and// responsive cancellation. To achieve// this, ensure that your code// is designed to respond appropriately// to cancellation requests using// the context.CancellationToken// mechanism. For more detailed// information and examples,// please, refer to our documentation./* ID of selected mailbox. */var mailBoxSettingId = Get<Guid>("SenderMailbox");/* Create an instance of the "EmailClientFactory." */var emailClientFactory = ClassFactory.Get<IEmailClientFactory>(new ConstructorArgument("userConnection", UserConnection));/* Create an instance of the "IEmailSender." */var emailSender = ClassFactory.Get<IEmailSender>(    new ConstructorArgument("emailClientFactory", emailClientFactory),    new ConstructorArgument("userConnection", UserConnection));var entity = UserConnection.EntitySchemaManager.GetInstanceByName("MailboxSyncSettings").CreateEntity(UserConnection);if (entity.FetchFromDB("Id", mailBoxSettingId, new List<string> { "SenderEmailAddress" })) {    /* Receive the sender mailbox from selected mailbox. */    var senderEmailAddress = entity.GetTypedColumnValue<string>("SenderEmailAddress");    /* Fill out the email parameters. */    var message = new Terrasoft.Mail.Sender.EmailMessage {        /* Mailbox of email sender. */        From = senderEmailAddress,                /* List of the recipient mailboxes. */        To = Get<string>("Recipient").Split(';').ToList<string>(),                /* List of the recipient mailboxes to send copy of the email. Optional.        Cc = List<string>{ "first@recepient.co", "second@recepient.co"},                List of the recipient mailboxes to send blind copy of the email. Optional.        Bcc = List<string>{ "first@recepient.co", "second@recepient.co"},*/                /* Email subject. */        Subject = Get<string>("Subject"),        /* Email body. */        Body = Get<string>("Body"),        /* Email priority. The value from the "Terrasoft.Mail.Sender.EmailPriority" enumeration. */        Priority = Terrasoft.Mail.Sender.EmailPriority.Normal    };    /* If needed, attach file to the email. */    /* Create an attachment. */    var attachment = new Terrasoft.Mail.Sender.EmailAttachment {        /* Attachment ID. */        Id = Guid.NewGuid(),        /* Attachment title. For example, "Some file.txt." */        Name = "Some file.txt",        /* Attachment data. For example, "Some data." */        Data = Encoding.ASCII.GetBytes("Some data")    };    /* Attach file to the email. */    message.Attachments.Add(attachment);        /* Send the email. */    emailSender.Send(message);}return true;