-- View and triggers that let you modify the target table-- Microsoft SQLIF EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VwSysAdminUnit]'))DROP VIEW [dbo].[VwSysAdminUnit]GOCREATE VIEW [dbo].[VwSysAdminUnit]ASSELECT [SysAdminUnit].[Id]    ,[SysAdminUnit].[CreatedOn]    ,[SysAdminUnit].[CreatedById]    ,[SysAdminUnit].[ModifiedOn]    ,[SysAdminUnit].[ModifiedById]    ,[SysAdminUnit].[Name]    ,[SysAdminUnit].[Description]    ,[SysAdminUnit].[ParentRoleId]    ,[SysAdminUnit].[ContactId]    ,[SysAdminUnit].[IsDirectoryEntry]    ,[TimeZone].[Id] AS [TimeZoneId]    ,[SysAdminUnit].[UserPassword]    ,[SysAdminUnitType].[Id] AS [SysAdminUnitTypeId]    ,[SysAdminUnit].[AccountId]    ,[SysAdminUnit].[Active]    ,[SysAdminUnit].[LoggedIn]    ,[SysAdminUnit].[SynchronizeWithLDAP]    ,[SysAdminUnit].[LDAPEntry]    ,[SysAdminUnit].[LDAPEntryId]    ,[SysAdminUnit].[LDAPEntryDN]    ,[SysAdminUnit].[SysCultureId]    ,[SysAdminUnit].[ProcessListeners]    ,[SysAdminUnit].[PasswordExpireDate]    ,[SysAdminUnit].[HomePageId]    ,[SysAdminUnit].[ConnectionType]    ,[ConnectionType].[Id] AS [UserConnectionTypeId]    ,[SysAdminUnit].[ForceChangePassword]    ,[SysAdminUnit].[DateTimeFormatId]    ,[SysAdminUnit].[Id] as [SysAdminUnitId]    ,[SysAdminUnit].[SessionTimeout] as [SessionTimeout]FROM [SysAdminUnit]INNER JOIN [SysAdminUnitType] ON [SysAdminUnitType].[Value] = [SysAdminUnit].[SysAdminUnitTypeValue]LEFT JOIN [ConnectionType] AS [ConnectionType] ON [ConnectionType].[Value] = [SysAdminUnit].[ConnectionType]LEFT JOIN [TimeZone] AS [TimeZone] ON [TimeZone].[Code] = [SysAdminUnit].[TimeZoneId]GOCREATE TRIGGER [dbo].[ITR_VwSysAdminUnit_I]ON [dbo].[VwSysAdminUnit]    INSTEAD OF INSERTASBEGINSET NOCOUNT ON;INSERT INTO [SysAdminUnit](    [Id]    ,[CreatedOn]    ,[CreatedById]    ,[ModifiedOn]    ,[ModifiedById]    ,[Name]    ,[Description]    ,[ParentRoleId]    ,[ContactId]    ,[IsDirectoryEntry]    ,[TimeZoneId]    ,[UserPassword]    ,[SysAdminUnitTypeValue]    ,[AccountId]    ,[Active]    ,[LoggedIn]    ,[SynchronizeWithLDAP]    ,[LDAPEntry]    ,[LDAPEntryId]    ,[LDAPEntryDN]    ,[SysCultureId]    ,[ProcessListeners]    ,[PasswordExpireDate]    ,[HomePageId]    ,[ConnectionType]    ,[ForceChangePassword]    ,[DateTimeFormatId]    ,[SessionTimeout])SELECT [Id]    ,[CreatedOn]    ,[CreatedById]    ,[ModifiedOn]    ,[ModifiedById]    ,[Name]    ,[Description]    ,[ParentRoleId]    ,[ContactId]    ,[IsDirectoryEntry]    ,(SELECT COALESCE(        (SELECT [TimeZone].[Code] FROM [TimeZone]            WHERE [TimeZone].[Id] = [INSERTED].[TimeZoneId]), ''))    ,[UserPassword]    ,ISNULL((SELECT [SysAdminUnitType].[Value] FROM [SysAdminUnitType]        WHERE [SysAdminUnitType].[Id] = [INSERTED].[SysAdminUnitTypeId]), 4)    ,[AccountId]    ,[Active]    ,ISNULL([LoggedIn], 0)    ,[SynchronizeWithLDAP]    ,[LDAPEntry]    ,[LDAPEntryId]    ,[LDAPEntryDN]    ,[SysCultureId]    ,[ProcessListeners]    ,[PasswordExpireDate]    ,[HomePageId]    ,COALESCE([INSERTED].[ConnectionType],        (SELECT [ConnectionType].[Value] FROM [ConnectionType]        WHERE [ConnectionType].[Id] = [INSERTED].[UserConnectionTypeId]), 0)    ,ISNULL([ForceChangePassword], 0)    ,[DateTimeFormatId]    ,[SessionTimeout]FROM [INSERTED]ENDGOCREATE TRIGGER [dbo].[ITR_VwSysAdminUnit_U]ON [dbo].[VwSysAdminUnit]    INSTEAD OF UPDATEASBEGINSET NOCOUNT ON;UPDATE [SysAdminUnit]SET [SysAdminUnit].[CreatedOn] = [INSERTED].[CreatedOn]    ,[SysAdminUnit].[CreatedById] = [INSERTED].[CreatedById]    ,[SysAdminUnit].[ModifiedOn] =[INSERTED].[ModifiedOn]    ,[SysAdminUnit].[ModifiedById] = [INSERTED].[ModifiedById]    ,[SysAdminUnit].[Name] = [INSERTED].[Name]    ,[SysAdminUnit].[Description] = [INSERTED].[Description]    ,[SysAdminUnit].[ParentRoleId] = [INSERTED].[ParentRoleId]    ,[SysAdminUnit].[ContactId] = [INSERTED].[ContactId]    ,[SysAdminUnit].[IsDirectoryEntry] = [INSERTED].[IsDirectoryEntry]    ,[SysAdminUnit].[TimeZoneId] =        (SELECT COALESCE(            (SELECT [TimeZone].[Code] FROM [TimeZone]                WHERE [TimeZone].[Id] = [INSERTED].[TimeZoneId]), ''))    ,[SysAdminUnit].[UserPassword] = [INSERTED].[UserPassword]    ,[SysAdminUnit].[SysAdminUnitTypeValue] =        (SELECT [SysAdminUnitType].[Value] FROM [SysAdminUnitType]            WHERE [SysAdminUnitType].[Id] = [INSERTED].[SysAdminUnitTypeId])    ,[SysAdminUnit].[AccountId] = [INSERTED].[AccountId]    ,[SysAdminUnit].[Active] = [INSERTED].[Active]    ,[SysAdminUnit].[LoggedIn] = [INSERTED].[LoggedIn]    ,[SysAdminUnit].[SynchronizeWithLDAP] = [INSERTED].[SynchronizeWithLDAP]    ,[SysAdminUnit].[LDAPEntry] = [INSERTED].[LDAPEntry]    ,[SysAdminUnit].[LDAPEntryId] = [INSERTED].[LDAPEntryId]    ,[SysAdminUnit].[LDAPEntryDN] = [INSERTED].[LDAPEntryDN]    ,[SysAdminUnit].[SysCultureId] = [INSERTED].[SysCultureId]    ,[SysAdminUnit].[ProcessListeners] = [INSERTED].[ProcessListeners]    ,[SysAdminUnit].[PasswordExpireDate] = [INSERTED].[PasswordExpireDate]    ,[SysAdminUnit].[HomePageId] = [INSERTED].[HomePageId]    ,[SysAdminUnit].[ConnectionType] = COALESCE([INSERTED].[ConnectionType],        (SELECT [ConnectionType].[Value] FROM [ConnectionType]        WHERE [ConnectionType].[Id] = [INSERTED].[UserConnectionTypeId]), 0)    ,[SysAdminUnit].[ForceChangePassword] = [INSERTED].[ForceChangePassword]    ,[SysAdminUnit].[DateTimeFormatId] = [INSERTED].[DateTimeFormatId]    ,[SysAdminUnit].[SessionTimeout] = [INSERTED].[SessionTimeout]FROM [SysAdminUnit]INNER JOIN [INSERTED] ON [SysAdminUnit].[Id] = [INSERTED].[Id]ENDGOCREATE TRIGGER [dbo].[ITR_VwSysAdminUnit_D]ON [dbo].[VwSysAdminUnit]    INSTEAD OF DELETEASBEGINSET NOCOUNT ON;DELETE FROM [SysAdminUnit]WHERE EXISTS(SELECT * FROM [DELETED] WHERE [SysAdminUnit].[Id] = [DELETED].[Id])ENDGO